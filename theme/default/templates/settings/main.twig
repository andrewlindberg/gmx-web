{% extends 'base.twig' %}

{% import 'macros/forms.twig' as forms %}

{% block content %}
    <div class="uk-card uk-card-default uk-card-body uk-width-1-1@m">
        <div uk-grid>
            <div class="uk-width-1-4@m">
                <h1>{{ user.login }}</h1>
                <form action="{{ avatarForm.getAction() }}" method="post" enctype="multipart/form-data">
                    {{ csrf_token() }}
                    {% set holder =
                        '<div id="profile-img-tag" class="avatar__holder uk-margin"><img src="'
                        ~ upload_url(user.avatar) ~
                        '"></div>'
                    %}
                    {{ forms.element_file(avatarForm.avatar, holder) }}
                    <div class="form-group">
                        <input type="submit" class="uk-button uk-button-primary" value="{{ trans('buttons', 'save') }}">
                    </div>
                </form>
                <ul class="uk-tab-left" uk-tab="connect: #settings; animation: uk-animation-slide-top,uk-animation-slide-bottom">
                    <li class="uk-active"><a href="#">{{ trans('inputs', 'email') }}</a></li>
                    <li><a href="#">{{ trans('inputs', 'password') }}</a></li>
                    <li><a href="#">Socials</a></li>
                </ul>
            </div>

            <div class="uk-width-3-4@m">
                <ul id="settings" class="uk-switcher">
                    <li>
                        <div>
                            <form action="{{ emailForm.getAction() }}" method="post">
                                {{ csrf_token() }}
                                {{ forms.element_input(emailForm.email, {"label": true}) }}
                                <div class="form-group">
                                    <input type="submit" class="uk-button uk-button-primary" value="{{ trans('buttons', 'save') }}">
                                </div>
                            </form>
                        </div>
                    </li>
                    <li>
                        <div>
                            <form action="{{ passwordForm.getAction() }}" method="post">
                                {{ csrf_token() }}
                                {{ forms.element_input(passwordForm.old_password, {"label": true}) }}
                                {{ forms.element_input(passwordForm.new_password, {"label": true}) }}
                                {{ forms.element_input(passwordForm.repeat_password, {"label": true}) }}
                                <div class="form-group">
                                    <input type="submit" class="uk-button uk-button-primary" value="{{ trans('buttons', 'save') }}">
                                </div>
                            </form>
                        </div>
                    </li>
                    <li>
                        <div>

                        </div>
                    </li>
                </ul>
            </div>
        </div>
        {#{% include 'settings//tabs.twig' with {'href': currentHref} %}#}

    </div>
{% endblock %}

{% block javascript %}
    <script type="text/javascript">
        $('#{{ avatarForm.avatar.getId() }}').change(function() {
            if (this.files && this.files[0]) {
                var reader = new FileReader();

                reader.onload = function (e) {
                    $('#profile-img-tag').css('background-image', 'url(' + e.target.result + ')');
                };
                reader.readAsDataURL(this.files[0]);
            }
        });
	</script>
{% endblock %}
