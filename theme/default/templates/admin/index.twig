{% extends 'admin/admin.twig' %}
{% import 'macros/progress.twig' as progress %}

{% block title %}{{ title }} | {{ trans('labels', 'admin_panel') }} | {{ trans('labels', 'index') }}{% endblock %}

{% block content %}
<div class="uk-child-width-1-3@l uk-child-width-1-2@s uk-grid-small uk-grid-match" uk-grid>
	{% for item in adminmenu.getItems() if adminmenu.hasAccess(item) %}
		<div>
			<div class="uk-card uk-card-default uk-card-body">
				{% if item.getType() == 'item' %}
					<h3 class="uk-card-title main-title">
						<a href="{{ path_for(item.getRoute(), item.getParams()) }}">
							{% if item.getIcon() %}
								<i class="fas {{ item.getIcon() }} uk-margin-small-right"></i>
							{% endif %}
							{{ item.getTitle()|trim }}
						</a>
					</h3>
				{% elseif item.getType() == 'group' %}
					<h3 class="uk-card-title main-title">
						{% if item.getIcon() %}
							<i class="fas {{ item.getIcon() }} uk-margin-small-right"></i>
						{% endif %}
						{{ item.getTitle()|trim }}
					</h3>
					<div>
						<ul class="uk-nav uk-navbar-dropdown-nav">
							{% for subItem in item.getItems() if subItem.getType() == 'item' and adminmenu.hasAccess(subItem) %}
								<li>
									<a class="nav-link" href="{{ path_for(subItem.getRoute(), subItem.getParams()) }}">
										{% if subItem.getIcon() %}
											<i class="fas {{ subItem.getIcon() }} uk-margin-small-right"></i>
										{% endif %}
										{{ subItem.getTitle()|trim }}
									</a>
								</li>
							{% endfor %}
						</ul>
					</div>
				{% endif %}
			</div>
		</div>
	{% endfor %}
</div>
<div class="uk-child-width-1-1@l uk-child-width-1-1@s uk-grid-small uk-grid-match" uk-grid>
	<div class="uk-card uk-card-default uk-card-body">
		<h3 class="uk-card-title main-title">Online last week</h3>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js"></script>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.css">
		<script src="https://cdn.jsdelivr.net/gh/emn178/chartjs-plugin-labels/src/chartjs-plugin-labels.js"></script>
		<canvas id="myChart" width="400" height="400"></canvas>
		<script>
			window.chartColors = {
				red: 'rgb(255, 99, 132)',
				orange: 'rgb(255, 159, 64)',
				yellow: 'rgb(255, 205, 86)',
				green: 'rgb(75, 192, 192)',
				blue: 'rgb(54, 162, 235)',
				purple: 'rgb(153, 102, 255)',
				grey: 'rgb(201, 203, 207)'
			};
			// var myChart = new Chart(ctx, {
			// 	type: 'pie',
			// 	data: {
			// 		labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
			// 		datasets: [{
			// 			label: '# of Votes',
			// 			data: [12, 19, 3, 5, 2, 3],
			// 			labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
			// 			backgroundColor: [
			// 				window.chartColors.red,
			// 				window.chartColors.orange,
			// 				window.chartColors.yellow,
			// 				window.chartColors.green,
			// 				window.chartColors.blue,
			// 			],
			// 		}]
			// 	},
			// 	options: {
			// 		legend: {
			// 			display: false
			// 		},
			// 		plugins: {
			// 			labels: {
			// 				render: 'percentage',
			// 				precision: 1,
			// 				textShadow: false,
			// 				arc: false,
			// 				position: 'default',
			// 				overlap: true,
			// 				showActualPercentages: true,
			// 			}
			// 		}
			// 	}
			// });
			Chart.platform.disableCSSInjection = true;
			$(document).ready(function () {
				$.getJSON('/admin/charts/online', function (data) {
					var config = {
						type: 'line',
						data: {
							labels: data.dates,
							datasets: [{
								label: 'Players online',
								backgroundColor: window.chartColors.green,
								borderColor: window.chartColors.green,
								data: data.online,
								fill: false,
								steppedLine: true
							}]
						},
						options: {
							legend: {
								display: false
							},
							elements: {
								point:{
									radius: 0
								}
							},
							responsive: true,
							tooltips: {
								mode: 'index',
								intersect: false,
							},
							hover: {
								mode: 'nearest',
								intersect: true
							},
							scales: {
								xAxes: [{
									display: false,
									scaleLabel: {
										display: true,
										labelString: 'Date'
									}
								}],
								yAxes: [{
									display: true,
									scaleLabel: {
										display: true,
										labelString: 'Players'
									},
									ticks: {
										// forces step size to be 5 units
										stepSize: 100
									}
								}]
							}
						}
					};
					var ctx = document.getElementById('myChart');
					ctx.height = 300;
					var myChart = new Chart(ctx, config);
				});
			});
		</script>
	</div>
</div>
{% endblock %}
